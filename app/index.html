<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>taedal</title>

    <link rel="icon" type="image/svg+xml" href="/images/taedal-static.svg" />
    <link rel="icon" type="image/png" href="/images/taedal-logo-32.png" sizes="32x32" />
    <link rel="apple-touch-icon" href="/images/taedal-logo-180.png" />
    <meta name="theme-color" content="#000000" />

    <!-- Speed up connection to Pinata gateway for hero video -->
    <link rel="preconnect" href="https://plum-fascinating-armadillo-813.mypinata.cloud" crossorigin />
    <link rel="dns-prefetch" href="https://plum-fascinating-armadillo-813.mypinata.cloud" />

    <!-- Boot screen local assets (instant start) -->
    <link rel="preload" href="/images/unpacking.mp4" as="video" type="video/mp4" />
    <link rel="preload" href="/images/start-button.svg" as="image" type="image/svg+xml" />

    <!-- Optional local AR intro fallback -->
    <link rel="preload" href="/media/ar-intro.mp4" as="video" type="video/mp4" />

    <!-- Preload the homepage hero video so bytes are ready before React mounts -->
    <link
      rel="preload"
      as="video"
      href="https://plum-fascinating-armadillo-813.mypinata.cloud/ipfs/bafybeigtp5guwdkm52wrbapmijnlf2ezwb5mmrt7eur4cv4rghsvfik5jm"
      type="video/mp4"
      crossorigin
    />

    <!-- Existing preloads -->
    <link rel="preload" href="/media/similarity.webm" as="video" type="video/webm" />
    <link rel="preload" href="/media/taedal-coin.glb" as="fetch" crossorigin="anonymous" />
    <link rel="preload" href="/images/chatbot.webm" as="video" type="video/webm" />
    <link rel="preload" href="/images/chatbot.mp4"  as="video" type="video/mp4" />

    <!-- NOTE:
      Do NOT include the model-viewer CDN script here.
      The React wrapper (ModelViewer.tsx) dynamically imports '@google/model-viewer'
      and guards against duplicate registration. Keeping it out of index.html
      prevents "the name 'model-viewer' has already been used" and Lit/Three duplication warnings.
    -->
  </head>
  <body>
    <div id="root"></div>

    <!-- App entry -->
    <script type="module" src="/src/main.tsx"></script>

    <!-- Fallback bubble if nothing mounted after a moment -->
    <script>
      (function () {
        function injectFallback() {
          if (document.getElementById('assistant-dock-root')) return; // React dock exists
          if (document.getElementById('assistant-fallback')) return;
          var host = document.createElement('div');
          host.id = 'assistant-fallback';
          Object.assign(host.style, {
            position: 'fixed',
            right: '16px',
            bottom: '16px',
            zIndex: 2147483647,
            height: '56px',
            width: '56px',
            borderRadius: '9999px',
            border: '1px solid rgba(255,255,255,0.18)',
            background: 'rgba(17,17,17,0.95)',
            color: '#fff',
            display: 'grid',
            placeItems: 'center',
            boxShadow: '0 10px 32px rgba(0,0,0,0.45)',
            cursor: 'pointer'
          });
          host.title = 'Assistant (fallback)';
          host.textContent = 'ðŸ¦Š';
          host.onclick = function () {
            alert('Assistant fallback: React dock did not mount.\\nCheck console for [assistant] logs.');
          };
          document.body.appendChild(host);
          console.warn('[assistant] Fallback bubble injected (React dock not found).');
        }
        window.addEventListener('load', function () { setTimeout(injectFallback, 1500); });
      })();
    </script>
  </body>
</html>
